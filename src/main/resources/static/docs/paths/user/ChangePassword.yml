post:
  operationId: changePassword
  summary: Alterar a senha do usuário
  tags: [ 'Usuário - Minha Conta - Segurança' ]
  security:
    - BearerAuth: [ ]
  description: |
    Altera a senha do usuário. Para isso, é necessário que o usuário 
    informe a senha atual, a nova senha desejada e a confirmação da nova senha.
    A nova senha deve atender aos critérios de segurança definidos pela aplicação.
  requestBody:
    required: true
    content:
      application/json:
        schema:
          $ref: '../../components/schemas/user/ChangePasswordRequestDto.yml'
  responses:
    204:
      description: Senha alterada com sucesso. Nenhum conteúdo é retornado.
    400:
      description: Error lançado quando os dados de entrada são inválidos.
      content:
        application/json:
          schema:
            $ref: '../../components/schemas/error/ErrorResponseDto.yml'
          examples:
            IncorrectCurrentPassword:
              summary: Senha atual incorreta
              value:
                timestamp: "2024-06-15T14:30:00Z"
                status: 400
                errorCode: "PASSWORD_CURRENT_INCORRECT"
                developerMessage: "A Senha atual está incorreta."
                path: "/api/users/me/password"
            InvalidFormatCurrentPassword:
              summary: Senha atual com formato inválido
              value:
                timestamp: "2024-06-15T14:30:00Z"
                status: 400
                errorCode: "VALIDATION_FAILED"
                developerMessage: "A validação falhou. Verifique os detalhes dos campos para mais informações."
                path: "/api/users/me/password"
                fieldErrors:
                  - fieldName: "currentPassword"
                    errorCode: "PASSWORD_REQUIRED"
                    developerMessage: "A senha é obrigatória."
                  - fieldName: "currentPassword"
                    errorCode: "PASSWORD_INVALID_LENGTH"
                    developerMessage: "A senha deve ter entre 6 e 20 caracteres."
                  - fieldName: "currentPassword"
                    errorCode: "PASSWORD_NO_WHITESPACE"
                    developerMessage: "A senha não pode conter espaços em branco."
            InvalidFormatNewPassword:
              summary: Nova senha com formato inválido
              value:
                timestamp: "2024-06-15T14:30:00Z"
                status: 400
                errorCode: "VALIDATION_FAILED"
                developerMessage: "A validação falhou. Verifique os detalhes dos campos para mais informações."
                path: "/api/users/me/password"
                fieldErrors:
                  - fieldName: "newPassword"
                    errorCode: "PASSWORD_REQUIRED"
                    developerMessage: "A senha é obrigatória."
                  - fieldName: "newPassword"
                    errorCode: "PASSWORD_INVALID_LENGTH"
                    developerMessage: "A senha deve ter entre 6 e 20 caracteres."
                  - fieldName: "newPassword"
                    errorCode: "PASSWORD_NO_WHITESPACE"
                    developerMessage: "A senha não pode conter espaços em branco."
            InvalidFormatConfirmPassword:
              summary: Confirmação da senha com formato inválido
              value:
                timestamp: "2024-06-15T14:30:00Z"
                status: 400
                errorCode: "VALIDATION_FAILED"
                developerMessage: "A validação falhou. Verifique os detalhes dos campos para mais informações."
                path: "/api/users/me/password"
                fieldErrors:
                  - fieldName: "confirmPassword"
                    errorCode: "CONFIRM_PASSWORD_REQUIRED"
                    developerMessage: "A confirmação de senha é obrigatória."
                  - fieldName: "confirmPassword"
                    errorCode: "PASSWORD_INVALID_LENGTH"
                    developerMessage: "A senha deve ter entre 6 e 20 caracteres."
                  - fieldName: "confirmPassword"
                    errorCode: "PASSWORD_NO_WHITESPACE"
                    developerMessage: "A senha não pode conter espaços em branco."
                  - fieldName: "confirmPassword"
                    errorCode: "PASSWORDS_DO_NOT_MATCH"
                    developerMessage: "A senha de confirmação não corresponde à senha."
    401:
      $ref: '../../components/responses/UnauthorizedError.yml'
    500:
      $ref: '../../components/responses/InternalServerError.yml'
